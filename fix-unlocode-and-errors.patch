*** Begin Patch
*** Add File: app/utils/validators.py
+import re
+from typing import Set, Optional
+from fastapi import HTTPException
+
+_UNLOCODE_RE = re.compile(r"^[A-Z]{5}$")
+
+def ensure_valid_unlocode(unlocode: str, catalog: Optional[Set[str]] = None) -> str:
+    """
+    统一校验：
+      - 422: 格式非法（必须 A-Z 的 5 位）
+      - 404: 合法但不在白名单（catalog）
+    返回：大写格式化后的 UNLOCODE
+    """
+    u = (unlocode or "").upper()
+    if not _UNLOCODE_RE.match(u):
+        raise HTTPException(status_code=422, detail="invalid UNLOCODE format (A-Z x5)")
+    if catalog is not None and u not in catalog:
+        raise HTTPException(status_code=404, detail="port not found")
+    return u
+
*** End Patch
